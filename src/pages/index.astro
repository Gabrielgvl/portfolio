---
import Layout from '@/layouts/Layout.astro';
import HeroSection from '@/components/sections/HeroSection.astro';
import PainPointsSection from '@/components/sections/PainPointsSection.astro';
import ServicesSection from '@/components/sections/ServicesSection.astro';
import ProcessSection from '@/components/sections/ProcessSection.astro';
import CasesSection from '@/components/sections/CasesSection.astro';
import AboutSection from '@/components/sections/AboutSection.astro';
import CTASection from '@/components/sections/CTASection.astro';
import { getLocaleFromUrl, useTranslations, useTranslatedPath } from '@/i18n/utils';
import { getCollection } from 'astro:content';
import animationsUrl from '../scripts/animations.ts?url';

const locale = getLocaleFromUrl(Astro.url);
const t = useTranslations(locale);
const translatePath = useTranslatedPath(locale);

const casesEntry = (
  await getCollection('cases', ({ id }) => id.split('/').at(0) === locale)
).at(0);
const cases = casesEntry?.data ?? [];

const whatsappLink =
  'https://wa.me/5561991716125?text=Ol%C3%A1%2C%20vi%20seu%20site%20e%20gostaria%20de%20conversar';
const emailLink = 'mailto:gabriel@delima.net.br';
const casesPath = translatePath('/casos');
const aboutPath = translatePath('/about');
---

<Layout title={t('meta.title')} description={t('meta.description')}>
  <HeroSection t={t} primaryHref={whatsappLink} secondaryHref={casesPath} />
  <PainPointsSection t={t} />
  <ServicesSection t={t} />
  <ProcessSection t={t} />
  <CasesSection t={t} cases={cases} basePath={casesPath} />
  <AboutSection t={t} aboutHref={aboutPath} />
  <CTASection t={t} primaryHref={whatsappLink} secondaryHref={emailLink} />

  <script type="module" src={animationsUrl}></script>
</Layout>
